<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h1>Seu Perfil</h1>
    <h2 id="username"></h2>
    <h2 id="birthdate"></h2>

    <a href="./index.html">Fazer Login Novamente</a>
</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.7/axios.min.js"
    integrity="sha512-DdX/YwF5e41Ok+AI81HI8f5/5UsoxCVT9GKYZRIzpLxb8Twz4ZwPPX+jQMwMhNQ9b5+zDEefc+dcvQoPWGNZ3g=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
    var t = localStorage.getItem("token");
    var id;
    var username = document.getElementById("username");
    var birthdate = document.getElementById("birthdate");

    axios.get(`http://localhost:3000/user/id`, // endpoint para verificar se está logado
        {
            headers: {
                "Authorization": `Bearer ${t}`
            }
        }).then(response => {
            id = response.data;
            console.log("id: " + id);

            axios.get("http://localhost:3000/user", // endpoint para verificar se está logado
                {
                    headers: {
                        "Authorization": `Bearer ${t}`,
                    },
                    params: {
                        id: id
                    }
                }).then(response => {
                    username.innerText = "Username: " + response.data.userName;
                    birthdate.innerText = "Data de Nascimento: " + response.data.birthdate;

                    console.log(response.data);
                })
                .catch(err => {
                    console.log(err)
                    alert(err.message);
                    window.location = "../index.html";
                });
        })
        .catch(err => {
            console.log(err)
            window.location = "../index.html";
        });

</script>

</html>